## template: github.com/zero-os/0-templates/vm/0.0.1

### Description:
This template is responsible for managing a vm on a zero-os node.

### Schema:

- `memory`: amount of memory in MiB. Defaults to 128.
- `cpu`: number of virtual CPUs. Defaults to 1.
- `nics`: list of type Nic specifying the nics of this vm.
- `disks`: list of Disk that can be attached to the vm 
- `flist`: if specified the vm will boot from this flist and not the vdisk.
- `vnc`: the vnc port the machine is listening to.
- `ports`: List of Port.
- `tags`: List of vm tags. e.g ['tag']
- `configs`: List of type Config.
- `ztIdentity`: VM zerotier id. This is generated by the sal if not supplied.
- `ipxeUrl`: ipxe url to create the vm from. Use this to create a zeroos vm.

Nic:
- `id`: vxlan or vlan id
- `type`: NicType enum specifying the nic type
- `hwaddr`: nic's macaddress
- `name`: nic name
- `ztClient`: zerotier client instance name to use to authorize.

NicType enum: 
- `default` 
- `vlan`
- `vxlan`
- `bridge`

Disk:
- `name`: name of the vdisk service to be used for this disk
- `url`: disk url, set by the template by executing the `private_url` action on the vdisk.
- `mountPoint`: path where this disk should be mounted
- `filesystem`: filesystem of the disk
- `label`: label to be used for the disk on the vm

Config:
- `path`: the file path 
- `content`: the file content
- `name`: name for this config

Port:
- `name`: name for this portforward
- `source`: node source port
- `target`: container destination port

### Actions:
- `install`: creates a a vm and the hypervisor on the node.
- `uninstall`: destroys and deletes the service from 0-robot and the node.
- `shutdown`: Sends signal to the VM to shutdown this requires the VM to handle acpi signals.
  - Takes optional parameter force (defaults to false) to force the VM to shutdown
- `start`: starts a machine in shutdown state.
- `pause`: pause the vm.
- `resume`: resume the vm.
- `reboot`: reboot the vm.
- `reset`: reset the vm.
- `info`: Return status, nics, disks, vncport and ztIdentity from the vm
- `enable_vnc`: if a vnc port is specified, it opens the port.
- `disable_vnc`: if a vnc port is specified, it drops the port.

### Examples:
#### DSL (api interface):
```python
data = {
    'memory': 256,
    'cpu': 1,
    'nics': [{'type':'default', 'name': 'defaultnic'}],
    'flist': 'https://hub.gig.tech/gig-bootable/ubuntu:latest.flist',
    'ports':[{'source': 22, 'target': 22, 'name': 'ssh'}],
    'configs': [{'path': '/root/.ssh/authorized_keys', 'content': 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDC8tBgGU1', 'name': 'sshkey'}]
}
vm = robot.services.create('github.com/zero-os/0-templates/vm/0.0.1','vm1', data)
vm.schedule_action('install')
```

#### Blueprint (cli interface):
```yaml
services:
    - github.com/zero-os/0-templates/vm/0.0.1__vm1:
        flist: 'https://hub.gig.tech/gig-bootable/ubuntu:latest.flist'
        memory: 256
        cpu: 1
        nics: 
            - type: 'default'
              name: 'defaultnic'
        ports:
            - source: 22
              target: 22
              name: 'ssh'
        configs:
          - path: '/root/.ssh/authorized_keys'
            content: 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDC8tBgGU1'
            name: 'sshkey'



actions:
    - actions: ['install']
      service: vm1
```
