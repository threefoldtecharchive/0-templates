## template: github.com/jumpscale/digital_me/vm/0.0.1

### Description:
This template is responsible for managing a vm on digital me

### Schema:

- `memory`: amount of memory in MiB. Defaults to 128.
- `cpu`: number of virtual CPUs. Defaults to 1.
- `zerotier`: zerotier info Zerotier.
- `disks`: list of Disk that can be attached to the vm. 
- `image`: image name specifying if it is a `zero-os` or `ubuntu` image.
- `configs`: List of type Config. **optional**
- `ztIdentity`: VM zerotier id. This is generated by the sal if not supplied.
- `nodeId`: the node_id from the capacity registration of the the node you want to deploy the vm on.

Zerotier:
- `id`: zerotier network id.
- `ztClient`: zerotier client name to be used for authorization.

Disk:
- `label`: label to be given to the disk on the vm
- `diskType`: type of the disk. Value should be from enum DiskType.
- `size`: size of the disk.
- `mountPoint`: path where this disk should be mounted.
- `filesystem`: filesystem of the disk. Value should be from enum FsType.

Enum FsType:
- `btrfs`
- `ext4`
- `ext3`
- `ext2`

Enum DiskType:
- `hdd`
- `ssd`

Config:
- `path`: the file path 
- `content`: the file content
- `name`: name for this config


### Actions:
- `install`: creates a a vm and the hypervisor on the node.
- `uninstall`: destroys and deletes the service from 0-robot and the node.
- `shutdown`: Sends signal to the VM to shutdown this requires the VM to handle acpi signals.
  - Takes optional parameter force (defaults to false) to force the VM to shutdown
- `pause`: pause the vm.
- `resume`: resume the vm.
- `reboot`: reboot the vm.
- `reset`: reset the vm. this is a force reboot that doesn't use acpi.
- `enable_vnc`: if a vnc port is specified, it opens the port.
- `disable_vnc`: if a vnc port is specified, it drops the port.
- `zt_identity`: return the zt identity of the vm
- `info`: return information about the VM (ip, configuration, ...)

### Examples:
#### DSL (api interface):
```python
data = {
    'nodeId': '547c5d299411',
    'disks': [{
        'diskType': 'hdd',
        'size': 10,
        'mountPoint': '/mnt',
        'filesystem': 'btrfs',
        'label': 'test',
    }],
    'zerotier': {'id':'9f77fc393e820576', 'ztClient': 'main'},
    'image': 'ubuntu',
    'configs': [{'path': '/root/.ssh/authorized_keys', 'content': 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDC8tBgGU1', 'name': 'sshkey'}]
}
vm = api.services.create('github.com/jumpscale/digital_me/vm/0.0.1','vm1', data)
vm.schedule_action('install')
```

#### Blueprint (cli interface):
```yaml
services:
    - github.com/jumpscale/digital_me/vm/0.0.1__three:
          image: ubuntu
          nodeId: 547c5d299411
          configs:
            - path: '/root/.ssh/authorized_keys'
              content: 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDC8tBgGU1cUablDk6pKgr+sC3HGU8B4jPJp/28lVPR1DPdpJyzgdCUX+t75y8D18G3uHZG34D3zYc33G3KleI7yTy19vlHfQoakP1pJNaGI+Nm2UhvCRsccf+bescLlgJqXECW3eyaufPtwEnSd0TsFL6CEuaSGtsTif9Mkeil4M7+XfTVKFbibbRn7DoFyCQQGIlQOuphMrdaYep1TCsroKLTRU+QKRjvpVl8sGRdMLOuPCCjL77o5tVZUsm2N2HrIUOA2PzAdDS3rATA1HUogiyCNb1cSVJWadqTcdhj8e2qdIANmZFXhwIFZIr92kdMFx9F ser@wonderwoman'
              name: 'ssh'
          disks:
            - diskType: hdd
              size: 10
              mountPoint: /mnt
              filesystem: btrfs
              label: test
          zerotier:
            id: 9f77fc393e820576
            ztClient: main
actions:
    - template: github.com/jumpscale/digital_me/vm/0.0.1
      service: 'three'
      actions: ['install']

```
